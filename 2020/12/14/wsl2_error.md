## WSL2を別のパソコンに入れようとしたら大変だったよ

[前回](https://06-de15.github.io/memo.deee.tech/2020/12/7/wsl2)は、ラップトップにWSL2の設定をしていました。

今回はデスクトップの方でも開発環境を整えたかったので、前回と同様にドキュメントを見ながらやっていたのですが、
前回起きなかったトラブルが起きたのでこちらにメモを残します。(後々考えればそうだよねって物が多かったです。)

### WSL2を既定のバージョンに設定できない
[WSLのドキュメント](https://docs.microsoft.com/ja-jp/windows/wsl/install-win10#step-7---set-up-a-new-distribution)に書いてある、手順5の項目です。

```
wsl --set-default-version 2
```

こちらのコマンドを打つと、無効なコマンドです。と表示されました。

ドキュメントを読むと

お使いの OS によってサポートされていないことを意味しているため、
バージョンは1903、ビルド18362以上にする必要があると書いてあります。

### 1回目
失敗→ビルドが18362未満だった

### 2回目
失敗→バージョンもビルドも書いてある要件は満たしていた。なのに、**無効なコマンド**と出力される。

設定からWindows Updateを確認すると、更新プログラムが上手くダウンロードとインストールができていませんでした。

**更新プログラムのチェック**ボタンを押しても、失敗します。困った。

### 管理者権限
調べてみたら、ローカルユーザーアカウントに管理者の権限がないことが分かったので、追加しました。

権限を付与して、更新プログラムのチェックを押しても、やはり失敗します。

ググったら同じ様なトラブルが起こっていた人がいたので、読んでみたら、Windows10の更新に関する問題が書いている[サポートページ](https://support.microsoft.com/ja-jp/windows/windows-10-%E3%81%AE%E6%9B%B4%E6%96%B0%E3%81%AB%E9%96%A2%E3%81%99%E3%82%8B%E5%95%8F%E9%A1%8C%E3%81%AE%E3%83%88%E3%83%A9%E3%83%96%E3%83%AB%E3%82%B7%E3%83%A5%E3%83%BC%E3%83%86%E3%82%A3%E3%83%B3%E3%82%B0-188c2b0f-10a7-d72f-65b8-32d177eb136c)
の下の方に書いてある**高度な手順**のソフトウェア配布フォルダの名前を変更するの部分に書いてあるコマンドを順番に打つとできるようになると書いてあったので、
その通りにやり、再起動してから**更新プログラムのチェック**のボタンを押したら、無事に更新する事ができました。

### 3回目
成功→WSL2を既定のバージョンに設定することができました。

## Ubuntuを入れて起動するとエラーが表示される
手順6ディストリビューションをインストールする→成功

手順7 インストールしたディストリビューションを設定する→失敗

Ubuntuを起動して、ユーザーアカウントとパスワードを作成する必要があるのですが、それができずませんでした。

起動はするのですが、エラーがでて、キーボードで文字を打つとUbuntuが終了します。また、困った。

### 仮想化が無効になっていた
調べてみたら、このエラーについてまとめていてくれた人がいて助かりました。

[WSL2でエラー0X8037010を修正する方法](https://ja.compbs.com/how-fix-error-0x8037010-wsl2)

同じエラーが出たなら、このリンクの記事を参考にすると解決できると思います。ざっくりこちらにも手順を書いておきます。

・手順1 タスクマネージャーを起動して、**パーフォーマンス**の中に書いてある**仮想化**が無効か有効かをチェックする。

これが無効になっていた人は、手順2にいきます。有効だった人はすいませんが、分からないのでググってください。

・手順2 BIOSから仮想化をアクティブにする

BIOSを開いて、仮想化をアクティブにするのですが、やり方や表示されている項目が**メーカーによって異なる**と思うので、調べてください。

・手順3 PowerShell(管理者)でコマンドを打ってアクティブ化する

この手順をやったと思うですが、できたことによって記憶があやふやです...すみません。

この手順をやる前にタスクマネージャーを起動して、CPUの仮想化の所を見てみると有効になっているような気もします。大事な所を忘れてしまった。

ここまでやると、Ubuntuでユーザー名とパスワードが入れれるようになるはずです。
